<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Últimas Solicitudes</title>
    <!-- Estilos Mejorados -->
    <style>
        /* Importar Google Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Montserrat:wght@600&display=swap');

        /* Estilos generales */
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f9fafb;
            color: #333;
        }

        /* Header - Mantener sin cambios */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #2c3e50;
            padding: 20px;
            color: #fff;
            flex-wrap: wrap;
        }

        .section-title h1 {
            margin: 0;
            font-size: 2em;
            font-family: 'Montserrat', sans-serif;
        }

        .logo-container img {
            height: 60px;
        }

        /* Iconos sociales */
        .social-icons a {
            margin-left: 15px;
        }

        .social-icons img {
            width: 30px;
            height: 30px;
            transition: transform 0.3s;
        }

        .social-icons img:hover {
            transform: scale(1.1);
        }

        /* Contenedor de la tabla */
        .table-container {
            padding: 20px;
            overflow-x: auto; /* Permitir scroll horizontal en pantallas pequeñas */
        }

        /* Estilos de la tabla */
        #tablaSolicitudes {
            width: 100%;
            border-collapse: collapse;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            background-color: #fff;
            border-radius: 8px;
            overflow: hidden;
            font-size: 1em;
            margin: 0 auto;
        }

        #tablaSolicitudes thead {
            background-color: #3498db;
            color: #fff;
        }

        #tablaSolicitudes th, #tablaSolicitudes td {
            padding: 15px 20px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        #tablaSolicitudes th {
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        #tablaSolicitudes tbody tr:nth-child(even) {
            background-color: #f2f6fc;
        }

        #tablaSolicitudes tbody tr:hover {
            background-color: #e1f5fe;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        /* Estilos para las imágenes de carátula */
        #tablaSolicitudes img {
            border-radius: 4px;
            width: 60px;
            height: auto;
        }

        /* Responsividad */
        @media (max-width: 768px) {
            /* Ajustes en la cabecera para pantallas medianas */
            .header {
                flex-direction: column;
                align-items: flex-start;
            }

            .logo-container {
                margin-top: 10px;
            }

            .section-title h1 {
                font-size: 1.5em;
            }

            /* Tabla responsiva */
            #tablaSolicitudes thead {
                display: none; /* Ocultar encabezados en pantallas pequeñas */
            }

            #tablaSolicitudes, #tablaSolicitudes tbody, #tablaSolicitudes tr, #tablaSolicitudes td {
                display: block;
                width: 100%;
            }

            #tablaSolicitudes tr {
                margin-bottom: 15px;
                border: 1px solid #ddd;
                border-radius: 8px;
                padding: 10px;
                background-color: #fff;
            }

            #tablaSolicitudes td {
                text-align: right;
                padding-left: 50%;
                position: relative;
                padding: 10px 20px;
            }

            #tablaSolicitudes td::before {
                content: attr(data-label);
                position: absolute;
                left: 20px;
                width: 45%;
                padding-right: 10px;
                white-space: nowrap;
                text-align: left;
                font-weight: 500;
                font-family: 'Montserrat', sans-serif;
                color: #555;
            }

            /* Ajustar tamaño de las imágenes en pantallas pequeñas */
            #tablaSolicitudes img {
                width: 50px;
                height: auto;
            }
        }

        @media (max-width: 480px) {
            /* Ajustes adicionales para pantallas muy pequeñas */
            .social-icons {
                justify-content: center;
                width: 100%;
                margin-top: 10px;
            }
        }
    </style>
    <!-- Firebase SDKs -->
    <!-- Firebase App (core) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <!-- Firebase Firestore -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
</head>
<body>
    <div class="header">
        <div class="section-title">
            <h1>Últimas Solicitudes</h1>
        </div>
        <div class="logo-container">
            <img src="https://cdn.streamelements.com/uploads/fa3fe2b3-134b-4288-bfef-29948befc05f.png" alt="Logo" class="logo">
        </div>
        <div class="social-icons">
            <a href="https://www.twitch.tv/piravision" target="_blank">
                <img src="https://cdn.streamelements.com/uploads/4e340b43-7b0e-4bad-81d4-197c233827c4.png" alt="Twitch">
            </a>
            <a href="https://kick.com/piravision" target="_blank">
                <img src="https://cdn.streamelements.com/uploads/9e660f91-49cb-476f-b328-8a1e5d9706ae.png" alt="Kick">
            </a>
            <a href="https://discord.gg/7VEzeTy55R" target="_blank">
                <img src="https://cdn.streamelements.com/uploads/e731c1a0-344f-432d-bbf8-0590844f7e25.png" alt="Discord">
            </a>
            <a href="https://x.com/PiraVision" target="_blank">
                <img src="https://cdn.streamelements.com/uploads/aecdfafd-fb1e-41d7-91ff-cc7d5cb34a32.png" alt="X (Twitter)">
            </a>
            <a href="https://t.me/+UD7ZygM3MrlhNjg0" target="_blank">
                <img src="https://cdn.streamelements.com/uploads/16594692-335f-470e-9beb-fd542023ec96.png" alt="Telegram">
            </a>
        </div>
    </div>

    <div class="table-container">
        <table id="tablaSolicitudes">
            <thead>
                <tr>
                    <th>Nombre de Usuario</th>
                    <th>Título</th>
                    <th>Año</th>
                    <th>Tipo</th>
                    <th>Franja Horaria</th>
                    <th>Carátula</th>
                </tr>
            </thead>
            <tbody>
                <!-- Se agregan filas dinámicamente -->
            </tbody>
        </table>
    </div>

    <!-- Script para conectar con Firebase y mostrar las solicitudes -->
    <script>
        // Configuración de Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyBET8zN73NmBploRE8wgq_n737eR_hxpXw",
            authDomain: "solicitudesapp-b2632.firebaseapp.com",
            projectId: "solicitudesapp-b2632",
            storageBucket: "solicitudesapp-b2632.appspot.com",
            messagingSenderId: "542690661887",
            appId: "1:542690661887:web:da612bb06f56fcd5bfc3ca"
        };

        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        document.addEventListener('DOMContentLoaded', () => {
            const tablaSolicitudesBody = document.querySelector('#tablaSolicitudes tbody');

            // Función para agregar una solicitud a la tabla
            function addSolicitudToTable({ userName, title, year, type, franja, poster }) {
                const tr = document.createElement('tr');

                const tdUser = document.createElement('td');
                tdUser.textContent = userName;
                tdUser.setAttribute('data-label', 'Nombre de Usuario');

                const tdTitle = document.createElement('td');
                tdTitle.textContent = title;
                tdTitle.setAttribute('data-label', 'Título');

                const tdYear = document.createElement('td');
                tdYear.textContent = year;
                tdYear.setAttribute('data-label', 'Año');

                const tdType = document.createElement('td');
                tdType.textContent = type;
                tdType.setAttribute('data-label', 'Tipo');

                const tdFranja = document.createElement('td');
                tdFranja.textContent = franja;
                tdFranja.setAttribute('data-label', 'Franja Horaria');

                const tdPoster = document.createElement('td');
                tdPoster.setAttribute('data-label', 'Carátula');
                if (poster) {
                    const img = document.createElement('img');
                    img.src = poster;
                    img.alt = "Carátula";
                    tdPoster.appendChild(img);
                } else {
                    tdPoster.textContent = 'N/A';
                }

                tr.appendChild(tdUser);
                tr.appendChild(tdTitle);
                tr.appendChild(tdYear);
                tr.appendChild(tdType);
                tr.appendChild(tdFranja);
                tr.appendChild(tdPoster);

                tablaSolicitudesBody.appendChild(tr);
            }

            // Función para obtener y mostrar todas las solicitudes ordenadas por timestamp descendente
            async function fetchSolicitudes() {
                try {
                    const solicitudesSnapshot = await db.collection('solicitudes')
                        .orderBy('timestamp', 'desc')
                        .get();

                    if (solicitudesSnapshot.empty) {
                        tablaSolicitudesBody.innerHTML = "<tr><td colspan='6'>No hay solicitudes disponibles.</td></tr>";
                        return;
                    }

                    solicitudesSnapshot.forEach(doc => {
                        const solicitud = doc.data();
                        addSolicitudToTable(solicitud);
                    });
                } catch (error) {
                    console.error("Error al obtener las solicitudes:", error);
                    tablaSolicitudesBody.innerHTML = "<tr><td colspan='6'>Error al cargar las solicitudes.</td></tr>";
                }
            }

            // Llamar a la función para cargar las solicitudes al cargar la página
            fetchSolicitudes();
        });
    </script>
</body>
</html>

